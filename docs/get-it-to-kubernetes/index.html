<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<title data-react-helmet="true">Get It To Kubernetes | App to K8s</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Get It To Kubernetes | App to K8s"><meta data-react-helmet="true" name="description" content="Kubernetes has many things"><meta data-react-helmet="true" property="og:description" content="Kubernetes has many things"><meta data-react-helmet="true" property="og:url" content="https://moficodes.github.com/app-to-k8s/docs/get-it-to-kubernetes"><link data-react-helmet="true" rel="shortcut icon" href="/app-to-k8s/img/k8s-icon.png"><link data-react-helmet="true" rel="canonical" href="https://moficodes.github.com/app-to-k8s/docs/get-it-to-kubernetes"><link rel="stylesheet" href="/app-to-k8s/styles.4b5091be.css">
<link rel="preload" href="/app-to-k8s/styles.c766f05e.js" as="script">
<link rel="preload" href="/app-to-k8s/runtime~main.0ae525ae.js" as="script">
<link rel="preload" href="/app-to-k8s/main.731e469b.js" as="script">
<link rel="preload" href="/app-to-k8s/1.2525661c.js" as="script">
<link rel="preload" href="/app-to-k8s/2.7f73ed64.js" as="script">
<link rel="preload" href="/app-to-k8s/36.98e8eb0a.js" as="script">
<link rel="preload" href="/app-to-k8s/37.6b2984da.js" as="script">
<link rel="preload" href="/app-to-k8s/a1694d8d.506d67fe.js" as="script">
<link rel="preload" href="/app-to-k8s/17896441.d74c7bc7.js" as="script">
<link rel="preload" href="/app-to-k8s/0b8fe33f.69b5abf6.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/app-to-k8s/"><img class="navbar__logo" src="/app-to-k8s/img/k8s-icon.png" alt="Kubernetes logo"><strong class="navbar__title">Kubernetes</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/app-to-k8s/docs/">Docs</a><a href="https://twitter.com/moficodes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">@moficodes</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/moficodes/app-to-k8s" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/app-to-k8s/"><img class="navbar__logo" src="/app-to-k8s/img/k8s-icon.png" alt="Kubernetes logo"><strong class="navbar__title">Kubernetes</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/app-to-k8s/docs/">Docs</a></li><li class="menu__list-item"><a href="https://twitter.com/moficodes" target="_blank" rel="noopener noreferrer" class="menu__link">@moficodes</a></li><li class="menu__list-item"><a href="https://github.com/moficodes/app-to-k8s" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp" role="complementary"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/app-to-k8s/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/app-to-k8s/docs/setup">Setup</a></li><li class="menu__list-item"><a class="menu__link" href="/app-to-k8s/docs/shallow-dive">Kubernetes Shallow Dive</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Workshop</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/app-to-k8s/docs/workshop-intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/app-to-k8s/docs/the-application">The Application</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/app-to-k8s/docs/containerize">Containerize</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/app-to-k8s/docs/get-it-to-kubernetes">Get It To Kubernetes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/app-to-k8s/docs/get-it-to-kubernetes-right">Get It To Kubernetes Right</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/app-to-k8s/docs/kubernetes-best-practices">Kubernetes Best Practices</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/app-to-k8s/docs/next-steps">Next Steps</a></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Get It To Kubernetes</h1></header><div class="markdown"><p>Kubernetes has many things</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-text codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">NAME                              SHORTNAMES   APIGROUP                       NAMESPACED   KIND</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">bindings                                                                      true         Binding</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">componentstatuses                 cs                                          false        ComponentStatus</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">configmaps                        cm                                          true         ConfigMap</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">endpoints                         ep                                          true         Endpoints</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">events                            ev                                          true         Event</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">limitranges                       limits                                      true         LimitRange</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespaces                        ns                                          false        Namespace</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">nodes                             no                                          false        Node</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">persistentvolumeclaims            pvc                                         true         PersistentVolumeClaim</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">persistentvolumes                 pv                                          false        PersistentVolume</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pods                              po                                          true         Pod</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">podtemplates                                                                  true         PodTemplate</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">replicationcontrollers            rc                                          true         ReplicationController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">resourcequotas                    quota                                       true         ResourceQuota</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">secrets                                                                       true         Secret</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">serviceaccounts                   sa                                          true         ServiceAccount</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">services                          svc                                         true         Service</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">initializerconfigurations                      admissionregistration.k8s.io   false        InitializerConfiguration</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">mutatingwebhookconfigurations                  admissionregistration.k8s.io   false        MutatingWebhookConfiguration</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">validatingwebhookconfigurations                admissionregistration.k8s.io   false        ValidatingWebhookConfiguration</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">customresourcedefinitions         crd,crds     apiextensions.k8s.io           false        CustomResourceDefinition</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">apiservices                                    apiregistration.k8s.io         false        APIService</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">controllerrevisions                            apps                           true         ControllerRevision</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">daemonsets                        ds           apps                           true         DaemonSet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">deployments                       deploy       apps                           true         Deployment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">replicasets                       rs           apps                           true         ReplicaSet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">statefulsets                      sts          apps                           true         StatefulSet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">meshpolicies                                   authentication.istio.io        false        MeshPolicy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">policies                                       authentication.istio.io        true         Policy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tokenreviews                                   authentication.k8s.io          false        TokenReview</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">localsubjectaccessreviews                      authorization.k8s.io           true         LocalSubjectAccessReview</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">selfsubjectaccessreviews                       authorization.k8s.io           false        SelfSubjectAccessReview</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">selfsubjectrulesreviews                        authorization.k8s.io           false        SelfSubjectRulesReview</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">subjectaccessreviews                           authorization.k8s.io           false        SubjectAccessReview</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">horizontalpodautoscalers          hpa          autoscaling                    true         HorizontalPodAutoscaler</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cronjobs                          cj           batch                          true         CronJob</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">jobs                                           batch                          true         Job</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">certificatesigningrequests        csr          certificates.k8s.io            false        CertificateSigningRequest</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">certificates                      cert,certs   certmanager.k8s.io             true         Certificate</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">challenges                                     certmanager.k8s.io             true         Challenge</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">clusterissuers                                 certmanager.k8s.io             false        ClusterIssuer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">issuers                                        certmanager.k8s.io             true         Issuer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">orders                                         certmanager.k8s.io             true         Order</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">leases                                         coordination.k8s.io            true         Lease</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">events                            ev           events.k8s.io                  true         Event</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">daemonsets                        ds           extensions                     true         DaemonSet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">deployments                       deploy       extensions                     true         Deployment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ingresses                         ing          extensions                     true         Ingress</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">networkpolicies                   netpol       extensions                     true         NetworkPolicy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">podsecuritypolicies               psp          extensions                     false        PodSecurityPolicy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">replicasets                       rs           extensions                     true         ReplicaSet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">nodes                                          metrics.k8s.io                 false        NodeMetrics</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pods                                           metrics.k8s.io                 true         PodMetrics</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">networkpolicies                   netpol       networking.k8s.io              true         NetworkPolicy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">poddisruptionbudgets              pdb          policy                         true         PodDisruptionBudget</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">podsecuritypolicies               psp          policy                         false        PodSecurityPolicy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">clusterrolebindings                            rbac.authorization.k8s.io      false        ClusterRoleBinding</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">clusterroles                                   rbac.authorization.k8s.io      false        ClusterRole</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">rolebindings                                   rbac.authorization.k8s.io      true         RoleBinding</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">roles                                          rbac.authorization.k8s.io      true         Role</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">priorityclasses                   pc           scheduling.k8s.io              false        PriorityClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">storageclasses                    sc           storage.k8s.io                 false        StorageClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">volumeattachments                              storage.k8s.io                 false        VolumeAttachment</span></div></div></div></div></div><p>To get our app to run on K8S we don&#x27;t need to know all of them. At the bare minimum we need to deal with 3 of these. Pods, Deployments and Services.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="pods"></a>Pods<a aria-hidden="true" tabindex="-1" class="hash-link" href="#pods" title="Direct link to heading">#</a></h3><p>Pods is the smallest unit in kubernetes. Each pod has to have atleast one container. But can have more. In some advanced kubernetes setup there are more that one container. Sidecar container, init container etc. </p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-text codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">apiVersion: v1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kind: Pod</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">metadata:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  name: pod-example</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">spec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  containers:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - name: ubuntu</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    image: ubuntu:trusty</span></div></div></div></div></div><p>This is the most minimal pod you can create. </p><table><thead><tr><th align="left">Field</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>apiVersion</code> string</td><td align="left">APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: <a href="https://git.k8s.io/community/contributors/devel/api-conventions.md%5C#resources">https://git.k8s.io/community/contributors/devel/api-conventions.md\#resources</a></td></tr><tr><td align="left"><code>kind</code> string</td><td align="left">Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: <a href="https://git.k8s.io/community/contributors/devel/api-conventions.md%5C#types-kinds">https://git.k8s.io/community/contributors/devel/api-conventions.md\#types-kinds</a></td></tr><tr><td align="left"><code>metadata</code> <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.14/#objectmeta-v1-meta" target="_blank" rel="noopener noreferrer">ObjectMeta</a></td><td align="left">Standard object&#x27;s metadata. More info: <a href="https://git.k8s.io/community/contributors/devel/api-conventions.md%5C#metadata">https://git.k8s.io/community/contributors/devel/api-conventions.md\#metadata</a></td></tr><tr><td align="left"><code>spec</code> <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.14/#podspec-v1-core" target="_blank" rel="noopener noreferrer">PodSpec</a></td><td align="left">Specification of the desired behavior of the pod. More info: <a href="https://git.k8s.io/community/contributors/devel/api-conventions.md%5C#spec-and-status">https://git.k8s.io/community/contributors/devel/api-conventions.md\#spec-and-status</a></td></tr></tbody></table><p>In k8s we should never create a pod this way. Because pods by itself can not self restart or scale if needed.</p><p>For that we use a replicaset or deployment.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="deployment"></a>Deployment<a aria-hidden="true" tabindex="-1" class="hash-link" href="#deployment" title="Direct link to heading">#</a></h3><p>A <em>Deployment</em> controller provides declarative updates for <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod/" target="_blank" rel="noopener noreferrer">Pods</a> and <a href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/" target="_blank" rel="noopener noreferrer">ReplicaSets</a>.</p><p>You describe a <em>desired state</em> in a Deployment object, and the Deployment controller changes the actual state to the desired state at a controlled rate. You can define Deployments to create new ReplicaSets, or to remove existing Deployments and adopt all their resources with new Deployments.</p><p>The quick and dirty way to create a deployment is to use the run command.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-text codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl run nginx --image=nginx:1.10 --replicas=3</span></div></div></div></div></div><p>But this is not preferred because its not reproducible. We should use a yaml file and check it in version control. </p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-text codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">apiVersion: apps/v1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kind: Deployment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">metadata:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # Unique key of the Deployment instance</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  name: deployment-example</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">spec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # 3 Pods should exist at all times.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  replicas: 3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  template:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    metadata:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      labels:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Apply this label to pods and default</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # the Deployment label selector to this value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        app: nginx</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    spec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      containers:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - name: nginx</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Run this image</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        image: nginx:1.10</span></div></div></div></div></div><p>The pod spec is embedded in the deployment under template.</p><p>Finally we need a way to make the app available to the world. We use a service for that.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="service"></a>Service<a aria-hidden="true" tabindex="-1" class="hash-link" href="#service" title="Direct link to heading">#</a></h3><p>Kubernetes <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod/" target="_blank" rel="noopener noreferrer"><code>Pods</code></a> are mortal. They are born and when they die, they are not resurrected. <a href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/" target="_blank" rel="noopener noreferrer"><code>ReplicaSets</code></a> in particular create and destroy <code>Pods</code> dynamically (e.g. when scaling out or in). While each <code>Pod</code> gets its own IP address, even those IP addresses cannot be relied upon to be stable over time. This leads to a problem: if some set of <code>Pods</code> (let’s call them backends) provides functionality to other <code>Pods</code> (let’s call them frontends) inside the Kubernetes cluster, how do those frontends find out and keep track of which backends are in that set?</p><p>Enter <code>Services</code>.</p><p>A Kubernetes <code>Service</code> is an abstraction which defines a logical set of <code>Pods</code> and a policy by which to access them - sometimes called a micro-service. The set of <code>Pods</code> targeted by a <code>Service</code> is (usually) determined by a <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors" target="_blank" rel="noopener noreferrer"><code>Label Selector</code></a> (see below for why you might want a <code>Service</code> without a selector).</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-text codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kind: Service</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">apiVersion: v1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">metadata:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # Unique key of the Service instance</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  name: service-example</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">spec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ports:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    # Accept traffic sent to port 80</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    - name: http</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      port: 80</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      targetPort: 80</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  selector:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    # this label selector</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    app: nginx</span></div></div></div></div></div><p>There are few types of services out there.</p><p>For some parts of your application (e.g. frontends) you may want to expose a Service onto an external (outside of your cluster) IP address.</p><p>Kubernetes <code>ServiceTypes</code> allow you to specify what kind of service you want. The default is <code>ClusterIP</code>.</p><p><code>Type</code> values and their behaviors are:</p><ul><li><code>ClusterIP</code>: Exposes the service on a cluster-internal IP. Choosing this value makes the service only reachable from within the cluster. This is the default <code>ServiceType</code>.</li><li><a href="https://kubernetes.io/docs/concepts/services-networking/service/#nodeport" target="_blank" rel="noopener noreferrer"><code>NodePort</code></a>: Exposes the service on each Node’s IP at a static port (the <code>NodePort</code>). A <code>ClusterIP</code> service, to which the <code>NodePort</code> service will route, is automatically created. You’ll be able to contact the <code>NodePort</code> service, from outside the cluster, by requesting <code>&lt;NodeIP&gt;:&lt;NodePort&gt;</code>.</li><li><a href="https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer" target="_blank" rel="noopener noreferrer"><code>LoadBalancer</code></a>: Exposes the service externally using a cloud provider’s load balancer. <code>NodePort</code> and <code>ClusterIP</code> services, to which the external load balancer will route, are automatically created.</li><li><a href="https://kubernetes.io/docs/concepts/services-networking/service/#externalname" target="_blank" rel="noopener noreferrer"><code>ExternalName</code></a>: Maps the service to the contents of the <code>externalName</code> field (e.g. <code>foo.bar.example.com</code>), by returning a <code>CNAME</code> record with its value. No proxying of any kind is set up. This requires version 1.7 or higher of <code>kube-dns</code>.</li></ul><p>ClusterIP is cluster internal. We will see both ClusterIP and LoadBalancer in depth in a second.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/get-it-to-kubernetes.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/app-to-k8s/docs/containerize"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Containerize</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/app-to-k8s/docs/get-it-to-kubernetes-right"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Get It To Kubernetes Right »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pods" class="table-of-contents__link">Pods</a></li><li><a href="#deployment" class="table-of-contents__link">Deployment</a></li><li><a href="#service" class="table-of-contents__link">Service</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/moficodes" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://youtube.com/moficodes" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/users/10272405/moficodes" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li></ul></div></div><div class="text--center"><div>@moficodes - 2020</div></div></div></footer></div>
<script src="/app-to-k8s/styles.c766f05e.js"></script>
<script src="/app-to-k8s/runtime~main.0ae525ae.js"></script>
<script src="/app-to-k8s/main.731e469b.js"></script>
<script src="/app-to-k8s/1.2525661c.js"></script>
<script src="/app-to-k8s/2.7f73ed64.js"></script>
<script src="/app-to-k8s/36.98e8eb0a.js"></script>
<script src="/app-to-k8s/37.6b2984da.js"></script>
<script src="/app-to-k8s/a1694d8d.506d67fe.js"></script>
<script src="/app-to-k8s/17896441.d74c7bc7.js"></script>
<script src="/app-to-k8s/0b8fe33f.69b5abf6.js"></script>
</body>
</html>